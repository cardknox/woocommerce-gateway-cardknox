{"version":3,"file":"index.js","mappings":"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","sources":["webpack://wc-cardknox-blocks/./src/cardknox-payment-method.js","webpack://wc-cardknox-blocks/./src/components/CardknoxIFields.js","webpack://wc-cardknox-blocks/./src/components/CardknoxPaymentForm.js","webpack://wc-cardknox-blocks/./src/components/SavePaymentCheckbox.js","webpack://wc-cardknox-blocks/./src/hooks/useCardknoxIFields.js","webpack://wc-cardknox-blocks/./src/utils/cardknox-validator.js","webpack://wc-cardknox-blocks/./src/utils/constants.js","webpack://wc-cardknox-blocks/external window [\"wp\",\"element\"]","webpack://wc-cardknox-blocks/external window [\"wp\",\"htmlEntities\"]","webpack://wc-cardknox-blocks/external window [\"wp\",\"i18n\"]","webpack://wc-cardknox-blocks/external window \"React\"","webpack://wc-cardknox-blocks/webpack/bootstrap","webpack://wc-cardknox-blocks/webpack/runtime/compat get default export","webpack://wc-cardknox-blocks/webpack/runtime/define property getters","webpack://wc-cardknox-blocks/webpack/runtime/hasOwnProperty shorthand","webpack://wc-cardknox-blocks/webpack/runtime/make namespace object","webpack://wc-cardknox-blocks/./src/index.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { decodeEntities } from '@wordpress/html-entities';\nimport { createElement } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport CardknoxPaymentForm from './components/CardknoxPaymentForm';\nimport { PAYMENT_METHOD_NAME } from './utils/constants';\n\n// Get settings from global WC object\nconst getSettings = () => {\n    if (window.wc && window.wc.wcSettings) {\n        return window.wc.wcSettings.getSetting('cardknox_data', {});\n    }\n    // Fallback to checking wcSettings global\n    if (window.wcSettings) {\n        return window.wcSettings.getSetting('cardknox_data', {});\n    }\n    return {};\n};\n\nconst settings = getSettings();\n\nconst defaultLabel = __('Credit Card (Cardknox)', 'woocommerce-gateway-cardknox');\nconst label = decodeEntities(settings.title) || defaultLabel;\n\n/**\n * Content component wrapper\n */\nconst Content = (props) => createElement(CardknoxPaymentForm, props);\n\n/**\n * Label component\n */\nconst Label = () => createElement('span', null, label);\n\n/**\n * Cardknox payment method configuration\n */\nconst CardknoxPaymentMethod = {\n    name: PAYMENT_METHOD_NAME,\n    label: createElement(Label),\n    content: createElement(Content),\n    edit: createElement(Content),\n    canMakePayment: () => true,\n    ariaLabel: label,\n    supports: {\n        features: settings.supports ?? ['products'],\n        showSaveOption: settings.showSaveOption ?? false,\n        showSavedCards: Array.isArray(settings.savedCards) && settings.savedCards.length > 0,\n    },\n    placeOrderButtonLabel: __('Place Order', 'woocommerce-gateway-cardknox'),\n};\n\nexport default CardknoxPaymentMethod;","/**\n * External dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { useEffect } from '@wordpress/element';\n\nconst cardLogoUrl = 'https://plugin.cardknox.net/demo/wpdemo/wp-content/plugins/woocommerce-gateway-cardknox/images/card-logos.png';\n\nconst CardknoxIFields = ({ errors, onExpiryChange, ValidationInputError, cardData }) => {\n    const currentYear = new Date().getFullYear();\n\n    const validateExpiry = () => {\n        \n        if (!cardData.expiryMonth || !cardData.expiryYear) {\n            return false;\n        }\n\n        const currentDate = new Date();\n        const currentYear = currentDate.getFullYear();\n        const currentMonth = currentDate.getMonth() + 1;\n        const expMonth = parseInt(cardData.expiryMonth, 10);\n        const expYear = parseInt(cardData.expiryYear, 10);\n\n        if (expYear < currentYear || (expYear === currentYear && expMonth < currentMonth)) {\n            return false;\n        }\n\n        return true;\n    };\n\n    // Ensure no container borders; styling is inside iField\n    useEffect(() => {\n        const cardContainer = document.querySelector('.cardknox-iframe-container');\n        const cvvContainer = document.querySelector('.cvv-container');\n        if (cardContainer) cardContainer.style.border = '0';\n        if (cvvContainer) cvvContainer.style.border = '0';\n        \n    }, []);\n\n    return (\n        <div className=\"wc-cardknox-ifields credit-row\">\n            <div id=\"ifieldsError\" style={{ display: 'none', color: 'red', marginBottom: '10px' }}></div>\n\n            <div className=\"form-row form-row-wide\" style={{ paddingBottom: '0', margin: '0 0 15px 0', width: '100%' }}>\n                <label style={{ margin: '0 0 5px 0', lineHeight: 'inherit', display: 'block', fontWeight: 400 }} htmlFor=\"cardknox-card-number\">\n                    {__('Card Number', 'woocommerce-gateway-cardknox')} <span className=\"required\">*</span>\n                </label>\n\n                <div className=\"cardknox-card-number-wrapper\" style={{ position: 'relative' }}>\n                    <div className=\"cardknox-iframe-container\" style={{ position: 'relative', overflow: 'hidden', backgroundColor: '#fff', height: '65px' }}>\n                        <iframe\n                            data-ifields-id=\"card-number\"\n                            data-ifields-placeholder={__('Card Number', 'woocommerce-gateway-cardknox')}\n                            src=\"https://cdn.cardknox.com/ifields/3.0.2503.2101/ifield.htm\"\n                            frameBorder=\"0\"\n                            width=\"100%\"\n                            height=\"100%\"\n                            style={{ border: 0 }}\n                            title=\"Card Number\"\n                        ></iframe>\n                    </div>\n\n                    <div\n                        className=\"card-logos\"\n                        style={{\n                            position: 'absolute',\n                            right: '50px',\n                            top: '40%',\n                            transform: 'translateY(-50%)',\n                            height: '40px',\n                            width: '100%',\n                            backgroundImage: `url(${cardLogoUrl})`,\n                            backgroundSize: 'auto',\n                            backgroundRepeat: 'no-repeat',\n                            backgroundPosition: 'center right',\n                            pointerEvents: 'none',\n                        }}\n                    />\n                </div>\n\n                <div className=\"cardknox-error-container\">\n                    {/* Container used by the SDK + React error fallback */}\n                    <div data-ifields-id=\"card-number-error\"></div>\n                    {errors.cardNumber && <ValidationInputError errorMessage={errors.cardNumber} />}\n                </div>\n            </div>\n\n            <div className=\"cardknox-row\" style={{ display: 'flex', gap: '15px', marginBottom: '0px' }}>\n                <div className=\"form-row form-row-first\" style={{ flex: '1', margin: '0' }}>\n                    <label style={{ margin: '0 0 5px 0', lineHeight: 'inherit', display: 'block', fontWeight: 400 }} htmlFor=\"cardknox-expiry\">\n                        {__('Expiry (MM/YY)', 'woocommerce-gateway-cardknox')} <span className=\"required\">*</span>\n                    </label>\n                    <input\n                        id=\"cardknox-card-expiry\"\n                        className=\"input-text wc-credit-card-form-card-expiry\"\n                        inputMode=\"numeric\"\n                        autoComplete=\"cc-exp\"\n                        autoCorrect=\"no\"\n                        autoCapitalize=\"no\"\n                        spellCheck=\"no\"\n                        type=\"tel\"\n                        placeholder={__('MM / YY', 'woocommerce-gateway-cardknox')}\n                        style={{\n                            outline: 'none',\n                            border:\n                                errors.expiry || (!validateExpiry() && cardData.expiryMonth && cardData.expiryYear)\n                                    ? '1px solid red'\n                                    : '1px solid #000',\n                            borderRadius: '4px',\n                            padding: '0.618047em',\n                            width: '100%',\n                            height: '48px',\n                            backgroundColor: '#fff',\n                            fontWeight: 'inherit',\n                            boxSizing: 'border-box',\n                            fontSize: '16px',\n                        }}\n                        onChange={(e) => {\n                            const value = e.target.value.replace(/\\D/g, '');\n                            let formattedValue = value;\n\n                            if (value.length >= 2) {\n                                formattedValue = value.substr(0, 2) + ' / ' + value.substr(2, 2);\n                            }\n\n                            e.target.value = formattedValue;\n\n                            if (value.length >= 2) {\n                                const month = value.substr(0, 2);\n                                onExpiryChange('expiryMonth', month);\n                            }\n\n                            if (value.length === 4) {\n                                const year = '20' + value.substr(2, 2);\n                                onExpiryChange('expiryYear', year);\n                            }\n                        }}\n                    />\n                    {(errors.expiry || (!validateExpiry() && cardData.expiryMonth && cardData.expiryYear)) && (\n                        <ValidationInputError errorMessage={errors.expiry || __('Expiration must be in the future', 'woocommerce-gateway-cardknox')} />\n                    )}\n                </div>\n\n                <div className=\"form-row form-row-last\" style={{ flex: '1', margin: '0' }}>\n                    <label style={{ margin: '0 0 5px 0', lineHeight: 'inherit', display: 'block', fontWeight: 400 }} htmlFor=\"cardknox-cvv\">\n                        {__('CVV Code', 'woocommerce-gateway-cardknox')} <span className=\"required\">*</span>\n                    </label>\n                    <div className=\"cardknox-iframe-container cvv-container\" style={{ position: 'relative', overflow: 'hidden', backgroundColor: '#fff', height: '65px' }}>\n                        <iframe\n                            data-ifields-id=\"cvv\"\n                            data-ifields-placeholder={__('CVV', 'woocommerce-gateway-cardknox')}\n                            src=\"https://cdn.cardknox.com/ifields/3.0.2503.2101/ifield.htm\"\n                            frameBorder=\"0\"\n                            width=\"100%\"\n                            height=\"100%\"\n                            style={{ border: 0 }}\n                            title=\"CVV\"\n                        ></iframe>\n                    </div>\n                    <div data-ifields-id=\"cvv-error\"></div>\n                    {errors.cvv && <ValidationInputError errorMessage={errors.cvv} />}\n                </div>\n            </div>\n\n            {/* Hidden fields for tokens */}\n            <input type=\"hidden\" data-ifields-id=\"card-number-token\" name=\"xCardNum\" />\n            <input type=\"hidden\" data-ifields-id=\"cvv-token\" name=\"xCVV\" />\n\n            <div className=\"clear\"></div>\n        </div>\n    );\n};\n\nexport default CardknoxIFields;","/**\n * External dependencies\n */\nimport { useState, useEffect, useCallback, useRef } from '@wordpress/element';\nimport { __ } from '@wordpress/i18n';\n\n/**\n * Internal dependencies\n */\nimport CardknoxIFields from './CardknoxIFields';\nimport SavePaymentCheckbox from './SavePaymentCheckbox';\nimport useCardknoxIFields from '../hooks/useCardknoxIFields';\nimport { validateCardData } from '../utils/cardknox-validator';\n\n// Get settings helper\nconst getSettings = () => {\n    if (window.wc && window.wc.wcSettings) {\n        return window.wc.wcSettings.getSetting('cardknox_data', {});\n    }\n    if (window.wcSettings) {\n        return window.wcSettings.getSetting('cardknox_data', {});\n    }\n    return {};\n};\n\nconst CardknoxPaymentForm = (props) => {\n    // Handle both possible prop structures\n    const eventRegistration = props.eventRegistration || props.events;\n    const emitResponse = props.emitResponse;\n    const components = props.components || {};\n    \n    const settings = getSettings();\n    const [errors, setErrors] = useState({});\n    const [isValid, setIsValid] = useState(false);\n    const [saveCard, setSaveCard] = useState(false);\n    const [selectedToken, setSelectedToken] = useState('new');\n    const [cardData, setCardData] = useState({\n        cardNumber: '',\n        cvv: '',\n        expiryMonth: '',\n        expiryYear: '',\n        cardNumberToken: '',\n        cvvToken: '',\n    });\n\n    // Debug refs\n    const renderCountRef = useRef(0);\n    const prevGetTokensRef = useRef(null);\n    const prevCardDataRef = useRef(cardData);\n\n    // Latest refs to avoid re-subscribing payment handler on every render\n    const emitResponseRef = useRef(emitResponse);\n    const getTokensRef = useRef(null);\n    const cardDataRef = useRef(cardData);\n    const saveCardRef = useRef(saveCard);\n    const selectedTokenRef = useRef(selectedToken);\n    const errorsRef = useRef(errors);\n    const eventRegistrationRef = useRef(eventRegistration);\n    const paymentSubscriptionRef = useRef({ subscribed: false, unsubscribe: null });\n\n    // Log every render (throttled)\n    useEffect(() => {\n        renderCountRef.current += 1;\n    });\n\n    const {\n        initializeIFields,\n        getTokens,\n        clearFields,\n        focusField,\n    } = useCardknoxIFields();\n\n    // Keep latest values in refs\n    useEffect(() => { emitResponseRef.current = emitResponse; }, [emitResponse]);\n    useEffect(() => { getTokensRef.current = getTokens; }, [getTokens]);\n    useEffect(() => { cardDataRef.current = cardData; }, [cardData]);\n    useEffect(() => { saveCardRef.current = saveCard; }, [saveCard]);\n    useEffect(() => { selectedTokenRef.current = selectedToken; }, [selectedToken]);\n    useEffect(() => { errorsRef.current = errors; }, [errors]);\n    useEffect(() => { eventRegistrationRef.current = eventRegistration; }, [eventRegistration]);\n\n    // Log getTokens identity stability\n    useEffect(() => {\n        const changed = prevGetTokensRef.current !== getTokens;\n        prevGetTokensRef.current = getTokens;\n    }, [getTokens]);\n\n    // Log cardData ref stability\n    useEffect(() => {\n        const sameRef = prevCardDataRef.current === cardData;\n        prevCardDataRef.current = cardData;\n    }, [cardData]);\n\n    // Get ValidationInputError component or create a fallback\n    const ValidationInputError = components.ValidationInputError || \n        (({ errorMessage }) => {\n            if (!errorMessage) return null;\n            return <div className=\"wc-block-components-validation-error\" role=\"alert\">\n                <span>{errorMessage}</span>\n            </div>;\n        });\n\n    useEffect(() => {\n        // Initialize iFields when component mounts\n        const attemptInit = () => {\n            const hasKey = !!settings.iFieldsKey;\n            const hasSDK = !!window.setAccount && !!window.setIfieldStyle && !!window.addIfieldCallback;\n\n            if (hasKey && hasSDK) {\n                initializeIFields({\n                    iFieldsKey: settings.iFieldsKey,\n                    softwareName: settings.softwareName || 'WooCommerce',\n                    softwareVersion: settings.softwareVersion || '1.0.0',\n                    onUpdate: handleIFieldUpdate,\n                });\n            }\n        };\n\n        attemptInit();\n        // As the SDK may be enqueued separately, re-attempt after a short delay\n        const t = window.setTimeout(attemptInit, 300);\n        return () => {\n            window.clearTimeout(t);\n        };\n    }, [settings.iFieldsKey]);\n\n    // Subscribe once on mount; retry briefly until registration becomes available\n    useEffect(() => {\n        let isUnmounted = false;\n        let timeoutId = null;\n\n        const trySubscribe = () => {\n            if (isUnmounted || paymentSubscriptionRef.current.subscribed) {\n                return;\n            }\n\n            const registration = eventRegistrationRef.current;\n            const onSetup = registration?.onPaymentSetup;\n            const onProcessing = registration?.onPaymentProcessing;\n            const paymentEvent = onSetup || onProcessing;\n\n            if (!paymentEvent || !emitResponseRef.current) {\n                // retry shortly until available\n                timeoutId = window.setTimeout(trySubscribe, 200);\n                return;\n            }\n\n            const unsubscribe = paymentEvent(async () => {\n                const emitRes = emitResponseRef.current;\n                const selected = selectedTokenRef.current;\n                const card = cardDataRef.current;\n\n                try {\n                    // If using a saved token, we're done\n                    if (selected !== 'new') {\n                        return {\n                            type: emitRes.responseTypes.SUCCESS,\n                            meta: { paymentMethodData: { wc_token: selected } },\n                        };\n                    }\n\n                    // Validate only expiry here; let iFields handle number + cvv\n                    const validationErrors = validateCardData(card) || {};\n                    if (card.expiryMonth && card.expiryYear) {\n                        const currentDate = new Date();\n                        const currentYear = currentDate.getFullYear();\n                        const currentMonth = currentDate.getMonth() + 1;\n                        const expMonth = parseInt(card.expiryMonth, 10);\n                        const expYear = parseInt(card.expiryYear, 10);\n                        if (expYear < currentYear || (expYear === currentYear && expMonth < currentMonth)) {\n                            validationErrors.expiry = __('Expiration must be in the future', 'woocommerce-gateway-cardknox');\n                        }\n                    } else {\n                        validationErrors.expiry = __('Expiry date is required', 'woocommerce-gateway-cardknox');\n                    }\n\n                    if (Object.keys(validationErrors).length > 0) {\n                        setErrors(validationErrors);\n                        return {\n                            type: emitRes.responseTypes.ERROR,\n                            message: __('Please check your card details.', 'woocommerce-gateway-cardknox'),\n                        };\n                    }\n\n                    // Clear any component-side errors before tokenizing\n                    setErrors({});\n\n                    // Request tokens (this will also set/clear inline errors + focus invalid fields)\n                    const tokens = await getTokensRef.current();\n\n                    if (!tokens?.cardNumberToken || !tokens?.cvvToken) {\n                        return {\n                            type: emitRes.responseTypes.ERROR,\n                            message: __('Unable to process card data. Please try again.', 'woocommerce-gateway-cardknox'),\n                        };\n                    }\n\n                    return {\n                        type: emitRes.responseTypes.SUCCESS,\n                        meta: {\n                            paymentMethodData: {\n                                cardknox_card_token: tokens.cardNumberToken,\n                                cardknox_cvv_token: tokens.cvvToken,\n                                cardknox_exp_month: card.expiryMonth,\n                                cardknox_exp_year: card.expiryYear,\n                                cardknox_save_card: saveCardRef.current ? 'yes' : 'no',\n                                'wc-cardknox-new-payment-method': saveCardRef.current ? '1' : '',\n                            },\n                        },\n                    };\n                } catch (error) {\n                    return {\n                        type: emitRes.responseTypes.ERROR,\n                        message: error?.message || __('Payment processing failed.', 'woocommerce-gateway-cardknox'),\n                    };\n                }\n            });\n\n            paymentSubscriptionRef.current = { subscribed: true, unsubscribe };\n        };\n\n        trySubscribe();\n\n        return () => {\n            isUnmounted = true;\n            if (timeoutId) {\n                window.clearTimeout(timeoutId);\n            }\n            const { unsubscribe } = paymentSubscriptionRef.current || {};\n            if (typeof unsubscribe === 'function') {\n                unsubscribe();\n            }\n        };\n    }, []);\n\n    const handleIFieldUpdate = useCallback((data) => {\n        // Update validation state based on iField data\n        const newErrors = { ...errors };\n\n        // Check if tokens exist first\n        const cardNumberToken = document.querySelector('[data-ifields-id=\"card-number-token\"]')?.value;\n        const cvvToken = document.querySelector('[data-ifields-id=\"cvv-token\"]')?.value;\n\n        if (data.lastActiveField === 'card-number' || data.cardNumberLength !== undefined) {\n            if (cardNumberToken || data.cardNumberIsValid) {\n                delete newErrors.cardNumber;\n            } else if (data.cardNumberLength > 0 && !data.cardNumberIsValid) {\n                newErrors.cardNumber = __('Invalid card number', 'woocommerce-gateway-cardknox');\n            } else {\n                delete newErrors.cardNumber;\n            }\n        }\n\n        if (data.lastActiveField === 'cvv' || data.cvvLength !== undefined) {\n            if (cvvToken || data.cvvIsValid) {\n                delete newErrors.cvv;\n            } else if (data.cvvLength > 0 && !data.cvvIsValid) {\n                newErrors.cvv = __('Invalid CVV', 'woocommerce-gateway-cardknox');\n            } else {\n                delete newErrors.cvv;\n            }\n        }\n\n        setErrors(newErrors);\n        const cardNumberValid = !!(cardNumberToken || data.cardNumberIsValid);\n        const cvvValid = !!(cvvToken || data.cvvIsValid);\n        setIsValid(cardNumberValid && cvvValid);\n\n        // Containers must not draw borders now; iField content handles it. Clear any container borders.\n        const cardContainer = document.querySelector('.cardknox-iframe-container');\n        const cvvContainer = document.querySelector('.cvv-container');\n        if (cardContainer) cardContainer.style.border = '0';\n        if (cvvContainer) cvvContainer.style.border = '0';\n    }, [errors]);\n\n    const handleExpiryChange = (field, value) => {\n        setCardData(prev => ({\n            ...prev,\n            [field]: value,\n        }));\n        \n        // Clear expiry errors\n        const newErrors = { ...errors };\n        delete newErrors.expiry;\n        setErrors(newErrors);\n    };\n\n    const handleTokenChange = (token) => {\n        setSelectedToken(token);\n        if (token !== 'new') {\n            clearFields();\n        }\n    };\n\n    return (\n        <div className=\"wc-cardknox-payment-form\">\n            {selectedToken === 'new' && (\n                <>\n                    <CardknoxIFields\n                        errors={errors}\n                        onExpiryChange={handleExpiryChange}\n                        ValidationInputError={ValidationInputError}\n                        cardData={cardData}\n                    />\n\n                    {settings.showSaveOption && (\n                        <SavePaymentCheckbox\n                            checked={saveCard}\n                            onChange={setSaveCard}\n                        />\n                    )}\n                </>\n            )}\n        </div>\n    );\n};\n\nexport default CardknoxPaymentForm;\n","/**\n * External dependencies\n */\nimport { __ } from '@wordpress/i18n';\n\nconst SavePaymentCheckbox = ({ checked, onChange }) => {\n    return (\n        <div className=\"wc-payment-gateway-cardknox__save-payment-method wc-block-components-payment-methods__save-card-info\">\n            <label className=\"wc-block-components-checkbox wc-block-components-payment-methods__save-card-infos-checkbox\">\n                <input\n                    type=\"checkbox\"\n                    name=\"wc-cardknox-new-payment-method\"\n                    id=\"wc-cardknox-new-payment-method\"\n                    className=\"wc-block-components-checkbox__input\"\n                    checked={checked}\n                    onChange={(e) => onChange(e.target.checked)}\n                />\n                <svg className=\"wc-block-components-checkbox__mark\" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 20\">\n                    <path d=\"M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z\" />\n                </svg>\n                <span className=\"wc-block-components-chesckbox__label\">\n                    {__('Save payment information to my account for future purchases.', 'woocommerce-gateway-cardknox')}\n                </span>\n            </label>\n        </div>\n    );\n};\n\nexport default SavePaymentCheckbox;","import { useCallback, useRef } from '@wordpress/element';\n\nconst useCardknoxIFields = () => {\n\tconst isInitializedRef = useRef(false);\n\tconst updateCallbackRef = useRef(null);\n\n\t// Clears WooCommerce checkout banners that sometimes stick around\n\tconst clearWooNotices = () => {\n\t\tconst groups = document.querySelectorAll(\n\t\t\t'.woocommerce-NoticeGroup-checkout, .woocommerce-error, .woocommerce-message'\n\t\t);\n\t\tgroups.forEach((g) => g.remove());\n\t};\n\n\tconst initializeIFields = useCallback(\n\t\t({\n\t\t\tiFieldsKey,\n\t\t\tsoftwareName,\n\t\t\tsoftwareVersion,\n\t\t\tonUpdate, // (optional) last iFields state callback\n\t\t}) => {\n\t\t\tif (isInitializedRef.current) return;\n\t\t\tif (!window.setAccount) return;\n\n\t\t\tupdateCallbackRef.current = onUpdate || null;\n\n\t\t\t// Init account\n\t\t\twindow.setAccount(iFieldsKey, softwareName, softwareVersion);\n\n\t\t\t// Base styles INSIDE iframes (the iField itself)\n\t\t\tconst defaultStyle = {\n\t\t\t\toutline: 'none',\n\t\t\t\tborder: '1px solid #c3c3c3',\n\t\t\t\t'border-radius': '4px',\n\t\t\t\tpadding: '0.6180469716em',\n\t\t\t\twidth: '93%',\n\t\t\t\theight: '30px',\n\t\t\t\t'background-color': 'transparent',\n\t\t\t\t'font-weight': 'inherit',\n\t\t\t\t'box-shadow': 'none',\n\t\t\t\t'font-size': '16px',\n\t\t\t\t'font-family':\n\t\t\t\t\t'-apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif',\n\t\t\t};\n\n\t\t\tconst defaultStyleCvv = {\n\t\t\t\toutline: 'none',\n\t\t\t\tborder: '1px solid #c3c3c3',\n\t\t\t\t'border-radius': '4px',\n\t\t\t\tpadding: '0.6180469716em',\n\t\t\t\twidth: '86%',\n\t\t\t\theight: '28px',\n\t\t\t\t'background-color': 'transparent',\n\t\t\t\t'font-weight': 'inherit',\n\t\t\t\t'box-shadow': 'none',\n\t\t\t\t'font-size': '16px',\n\t\t\t\t'font-family':\n\t\t\t\t\t'-apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif',\n\t\t\t};\n\n\t\t\tconst validStyle = {\n\t\t\t\t...defaultStyle,\n\t\t\t\tborder: '1px solid #46b450',\n\t\t\t\t'background-color': '#f0f9f0',\n\t\t\t};\n\t\t\tconst invalidStyle = {\n\t\t\t\t...defaultStyle,\n\t\t\t\tborder: '1px solid #d63638',\n\t\t\t\t'background-color': '#fef5f5',\n\t\t\t};\n\t\t\tconst validStyleCvv = {\n\t\t\t\t...defaultStyleCvv,\n\t\t\t\tborder: '1px solid #46b450',\n\t\t\t\t'background-color': '#f0f9f0',\n\t\t\t};\n\t\t\tconst invalidStyleCvv = {\n\t\t\t\t...defaultStyleCvv,\n\t\t\t\tborder: '1px solid #d63638',\n\t\t\t\t'background-color': '#fef5f5',\n\t\t\t};\n\n\t\t\t// Set initial styles\n\t\t\tif (window.setIfieldStyle) {\n\t\t\t\twindow.setIfieldStyle('card-number', defaultStyle);\n\t\t\t\twindow.setIfieldStyle('cvv', defaultStyleCvv);\n\t\t\t}\n\n\t\t\t// Input formatting & ENTER support\n\t\t\twindow.enableAutoFormatting && window.enableAutoFormatting();\n\t\t\tif (window.enableEnterKey) {\n\t\t\t\twindow.enableEnterKey('card-number');\n\t\t\t\twindow.enableEnterKey('cvv');\n\t\t\t}\n\n\t\t\t// Modern callback -> fires on every keystroke with rich data\n\t\t\tif (window.addIfieldCallback && window.setIfieldStyle) {\n\t\t\t\twindow.addIfieldCallback('input', function (data) {\n\t\t\t\t\tupdateCallbackRef.current?.(data);\n\n\t\t\t\t\t// DOM nodes for inline errors (make sure these exist in your markup)\n\t\t\t\t\tconst cardNumberError = document.querySelector(\n\t\t\t\t\t\t'[data-ifields-id=\"card-number-error\"]'\n\t\t\t\t\t);\n\t\t\t\t\tconst cvvError = document.querySelector('[data-ifields-id=\"cvv-error\"]');\n\n\t\t\t\t\tconst cardLen =\n\t\t\t\t\t\ttypeof data.cardNumberLength === 'number' ? data.cardNumberLength : 0;\n\t\t\t\t\tconst cvvLen =\n\t\t\t\t\t\ttypeof data.cvvLength === 'number' ? data.cvvLength : 0;\n\n\t\t\t\t\t// Card Number visuals + message\n\t\t\t\t\twindow.setIfieldStyle(\n\t\t\t\t\t\t'card-number',\n\t\t\t\t\t\tcardLen <= 0\n\t\t\t\t\t\t\t? defaultStyle\n\t\t\t\t\t\t\t: data.cardNumberIsValid\n\t\t\t\t\t\t\t? validStyle\n\t\t\t\t\t\t\t: invalidStyle\n\t\t\t\t\t);\n\n\t\t\t\t\tif (cardNumberError) {\n\t\t\t\t\t\tcardNumberError.textContent =\n\t\t\t\t\t\t\tcardLen <= 0\n\t\t\t\t\t\t\t\t? 'Card Number is required'\n\t\t\t\t\t\t\t\t: data.cardNumberIsValid\n\t\t\t\t\t\t\t\t? ''\n\t\t\t\t\t\t\t\t: 'Invalid card number';\n\t\t\t\t\t\tcardNumberError.setAttribute(\n\t\t\t\t\t\t\t'aria-hidden',\n\t\t\t\t\t\t\tcardNumberError.textContent ? 'false' : 'true'\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\t// CVV visuals + message (depends on issuer)\n\t\t\t\t\tconst amex = data.issuer === 'amex';\n\t\t\t\t\tconst expectedLen = amex ? 4 : 3;\n\t\t\t\t\tconst cvvLooksValid = cvvLen === expectedLen && data.cvvIsValid;\n\n\t\t\t\t\twindow.setIfieldStyle(\n\t\t\t\t\t\t'cvv',\n\t\t\t\t\t\tdata.issuer === 'unknown' || cvvLen <= 0\n\t\t\t\t\t\t\t? defaultStyleCvv\n\t\t\t\t\t\t\t: cvvLooksValid\n\t\t\t\t\t\t\t? validStyleCvv\n\t\t\t\t\t\t\t: invalidStyleCvv\n\t\t\t\t\t);\n\t\t\t\t\tif (cvvError) {\n\t\t\t\t\t\tcvvError.textContent =\n\t\t\t\t\t\t\tcvvLen <= 0\n\t\t\t\t\t\t\t\t? 'CVV is required'\n\t\t\t\t\t\t\t\t: cvvLooksValid\n\t\t\t\t\t\t\t\t? ''\n\t\t\t\t\t\t\t\t: 'Invalid CVV';\n\t\t\t\t\t\tcvvError.setAttribute(\n\t\t\t\t\t\t\t'aria-hidden',\n\t\t\t\t\t\t\tcvvError.textContent ? 'false' : 'true'\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\t// If both fields are valid, also clear sticky Woo notices\n\t\t\t\t\tif (data.cardNumberIsValid && cvvLooksValid) {\n\t\t\t\t\t\tclearWooNotices();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// Update CVV when issuer changes (e.g. 3 -> 4 for Amex)\n\t\t\t\twindow.addIfieldCallback('issuerupdated', function (data) {\n\t\t\t\t\tconst cvvLen =\n\t\t\t\t\t\ttypeof data.cvvLength === 'number' ? data.cvvLength : 0;\n\t\t\t\t\tconst amex = data.issuer === 'amex';\n\t\t\t\t\tconst expectedLen = amex ? 4 : 3;\n\t\t\t\t\tconst cvvLooksValid = cvvLen === expectedLen && data.cvvIsValid;\n\n\t\t\t\t\twindow.setIfieldStyle(\n\t\t\t\t\t\t'cvv',\n\t\t\t\t\t\tdata.issuer === 'unknown' || cvvLen <= 0\n\t\t\t\t\t\t\t? defaultStyleCvv\n\t\t\t\t\t\t\t: cvvLooksValid\n\t\t\t\t\t\t\t? validStyleCvv\n\t\t\t\t\t\t\t: invalidStyleCvv\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t}\n\t\t\t// Fallback (older iFields only expose keypress callback)\n\t\t\telse if (window.addIfieldKeyPressCallback && window.setIfieldStyle) {\n\t\t\t\twindow.addIfieldKeyPressCallback(function (data) {\n\t\t\t\t\tupdateCallbackRef.current?.(data);\n\n\t\t\t\t\tconst cardNumberToken = document.querySelector(\n\t\t\t\t\t\t'[data-ifields-id=\"card-number-token\"]'\n\t\t\t\t\t)?.value;\n\t\t\t\t\tconst cvvToken = document.querySelector('[data-ifields-id=\"cvv-token\"]')\n\t\t\t\t\t\t?.value;\n\t\t\t\t\tconst cardNumberError = document.querySelector(\n\t\t\t\t\t\t'[data-ifields-id=\"card-number-error\"]'\n\t\t\t\t\t);\n\t\t\t\t\tconst cvvError = document.querySelector('[data-ifields-id=\"cvv-error\"]');\n\n\t\t\t\t\t// Card\n\t\t\t\t\tif (cardNumberToken || data.cardNumberIsValid) {\n\t\t\t\t\t\twindow.setIfieldStyle('card-number', validStyle);\n\t\t\t\t\t\tif (cardNumberError) cardNumberError.textContent = '';\n\t\t\t\t\t} else if (data.cardNumberLength > 0) {\n\t\t\t\t\t\twindow.setIfieldStyle('card-number', invalidStyle);\n\t\t\t\t\t\tif (cardNumberError)\n\t\t\t\t\t\t\tcardNumberError.textContent = 'Invalid card number';\n\t\t\t\t\t} else {\n\t\t\t\t\t\twindow.setIfieldStyle('card-number', defaultStyle);\n\t\t\t\t\t\tif (cardNumberError)\n\t\t\t\t\t\t\tcardNumberError.textContent = 'Card Number is required';\n\t\t\t\t\t}\n\n\t\t\t\t\t// CVV\n\t\t\t\t\tif (cvvToken || data.cvvIsValid) {\n\t\t\t\t\t\twindow.setIfieldStyle('cvv', validStyleCvv);\n\t\t\t\t\t\tif (cvvError) cvvError.textContent = '';\n\t\t\t\t\t} else if (data.cvvLength > 0) {\n\t\t\t\t\t\twindow.setIfieldStyle('cvv', invalidStyleCvv);\n\t\t\t\t\t\tif (cvvError) cvvError.textContent = 'Invalid CVV';\n\t\t\t\t\t} else {\n\t\t\t\t\t\twindow.setIfieldStyle('cvv', defaultStyleCvv);\n\t\t\t\t\t\tif (cvvError) cvvError.textContent = 'CVV is required';\n\t\t\t\t\t}\n\n\t\t\t\t\tif (\n\t\t\t\t\t\t(cardNumberToken || data.cardNumberIsValid) &&\n\t\t\t\t\t\t(cvvToken || data.cvvIsValid)\n\t\t\t\t\t) {\n\t\t\t\t\t\tclearWooNotices();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tisInitializedRef.current = true;\n\t\t},\n\t\t[]\n\t);\n\n\tconst getTokens = useCallback(() => {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif (!window.getTokens) {\n\t\t\t\treject(new Error('iFields not initialized'));\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// If tokens are already present, skip re-validation\n\t\t\tconst currentCardTok = document.querySelector(\n\t\t\t\t'[data-ifields-id=\"card-number-token\"]'\n\t\t\t)?.value;\n\t\t\tconst currentCvvTok = document.querySelector('[data-ifields-id=\"cvv-token\"]')\n\t\t\t\t?.value;\n\t\t\tif (currentCardTok && currentCvvTok) {\n\t\t\t\tclearWooNotices();\n\t\t\t\tresolve({\n\t\t\t\t\tcardNumberToken: currentCardTok,\n\t\t\t\t\tcvvToken: currentCvvTok,\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Prepare inline error nodes\n\t\t\tconst cardNumberError = document.querySelector(\n\t\t\t\t'[data-ifields-id=\"card-number-error\"]'\n\t\t\t);\n\t\t\tconst cvvError = document.querySelector('[data-ifields-id=\"cvv-error\"]');\n\t\t\tif (cardNumberError) cardNumberError.textContent = '';\n\t\t\tif (cvvError) cvvError.textContent = '';\n\n\t\t\t// Call iFields to tokenize; add our own timeout guard\n\t\t\tlet finished = false;\n\t\t\tconst tid = setTimeout(() => {\n\t\t\t\tif (finished) return;\n\t\t\t\tfinished = true;\n\t\t\t\treject(new Error('Timed out while validating card fields'));\n\t\t\t}, 15000);\n\n\t\t\twindow.getTokens(\n\t\t\t\t() => {\n\t\t\t\t\tif (finished) return;\n\t\t\t\t\tfinished = true;\n\t\t\t\t\tclearTimeout(tid);\n\n\t\t\t\t\tconst cardNumberToken = document.querySelector(\n\t\t\t\t\t\t'[data-ifields-id=\"card-number-token\"]'\n\t\t\t\t\t)?.value;\n\t\t\t\t\tconst cvvToken = document.querySelector(\n\t\t\t\t\t\t'[data-ifields-id=\"cvv-token\"]'\n\t\t\t\t\t)?.value;\n\n\t\t\t\t\t// If either is missing, show \"required\" and focus first\n\t\t\t\t\tif (!cardNumberToken || !cvvToken) {\n\t\t\t\t\t\tif (!cardNumberToken) {\n\t\t\t\t\t\t\tcardNumberError &&\n\t\t\t\t\t\t\t\t(cardNumberError.textContent = 'Card Number is required');\n\t\t\t\t\t\t\twindow.setIfieldStyle &&\n\t\t\t\t\t\t\t\twindow.setIfieldStyle('card-number', {\n\t\t\t\t\t\t\t\t\tborder: '1px solid #d63638',\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\twindow.focusIfield && window.focusIfield('card-number');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!cvvToken) {\n\t\t\t\t\t\t\tcvvError && (cvvError.textContent = 'CVV is required');\n\t\t\t\t\t\t\twindow.setIfieldStyle &&\n\t\t\t\t\t\t\t\twindow.setIfieldStyle('cvv', {\n\t\t\t\t\t\t\t\t\tborder: '1px solid #d63638',\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (cardNumberToken) {\n\t\t\t\t\t\t\t\twindow.focusIfield && window.focusIfield('cvv');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treject(new Error('Please fill in all required fields'));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Success: mark valid, clear error text, clear Woo banners\n\t\t\t\t\twindow.setIfieldStyle &&\n\t\t\t\t\t\twindow.setIfieldStyle('card-number', { border: '1px solid #46b450' });\n\t\t\t\t\twindow.setIfieldStyle &&\n\t\t\t\t\t\twindow.setIfieldStyle('cvv', { border: '1px solid #46b450' });\n\n\t\t\t\t\tif (cardNumberError) {\n\t\t\t\t\t\tcardNumberError.textContent = '';\n\t\t\t\t\t\tcardNumberError.setAttribute('aria-hidden', 'true');\n\t\t\t\t\t}\n\t\t\t\t\tif (cvvError) {\n\t\t\t\t\t\tcvvError.textContent = '';\n\t\t\t\t\t\tcvvError.setAttribute('aria-hidden', 'true');\n\t\t\t\t\t}\n\n\t\t\t\t\tclearWooNotices();\n\t\t\t\t\tresolve({ cardNumberToken, cvvToken });\n\t\t\t\t},\n\t\t\t\t(error) => {\n\t\t\t\t\tif (finished) return;\n\t\t\t\t\tfinished = true;\n\t\t\t\t\tclearTimeout(tid);\n\n\t\t\t\t\t// Conservative messages if the lib did not populate our errors\n\t\t\t\t\tconst cardNumberErrorEl = document.querySelector('[data-ifields-id=\"card-number-error\"]');\n\t\t\t\t\tconst cvvErrorEl = document.querySelector('[data-ifields-id=\"cvv-error\"]');\n\n\t\t\t\t\tif (cardNumberErrorEl && !cardNumberErrorEl.textContent) {\n\t\t\t\t\t\tcardNumberErrorEl.textContent = 'Invalid card number';\n\t\t\t\t\t}\n\t\t\t\t\tif (cvvErrorEl && !cvvErrorEl.textContent) {\n\t\t\t\t\t\tcvvErrorEl.textContent = 'Invalid CVV';\n\t\t\t\t\t}\n\n\t\t\t\t\t// Focus likely-invalid field to help user\n\t\t\t\t\tif (window.focusIfield) {\n\t\t\t\t\t\t// Prefer card first unless we know it's valid\n\t\t\t\t\t\tconst last =\n\t\t\t\t\t\t\twindow.getLastIfieldState && window.getLastIfieldState();\n\t\t\t\t\t\tconst target =\n\t\t\t\t\t\t\tlast && last.cardNumberIsValid ? 'cvv' : 'card-number';\n\t\t\t\t\t\twindow.focusIfield(target);\n\t\t\t\t\t}\n\n\t\t\t\t\treject(new Error(typeof error === 'string' ? error : 'Failed to get tokens'));\n\t\t\t\t},\n\t\t\t\t15000 // native lib timeout\n\t\t\t);\n\t\t});\n\t}, []);\n\n\tconst clearFields = useCallback(() => {\n\t\tif (window.clearIfield) {\n\t\t\twindow.clearIfield('card-number');\n\t\t\twindow.clearIfield('cvv');\n\t\t}\n\t}, []);\n\n\tconst focusField = useCallback((fieldName) => {\n\t\tif (window.focusIfield) {\n\t\t\twindow.focusIfield(fieldName);\n\t\t}\n\t}, []);\n\n\treturn {\n\t\tinitializeIFields,\n\t\tgetTokens,\n\t\tclearFields,\n\t\tfocusField,\n\t};\n};\n\nexport default useCardknoxIFields;","// ============================================\n// File: blocks/src/utils/cardknox-validator.js\n// ============================================\n\n/**\n * External dependencies\n */\nimport { __ } from '@wordpress/i18n';\n\n/**\n * Validate card data\n * @param {Object} cardData - Card data to validate\n * @returns {Object} Validation errors\n */\nexport const validateCardData = (cardData) => {\n    const errors = {};\n\n    // Validate expiry month\n    if (!cardData.expiryMonth) {\n        errors.expiry = __('Expiry month is required', 'woocommerce-gateway-cardknox');\n    } else {\n        const month = parseInt(cardData.expiryMonth, 10);\n        if (month < 1 || month > 12) {\n            errors.expiry = __('Invalid expiry month', 'woocommerce-gateway-cardknox');\n        }\n    }\n\n    // Validate expiry year\n    if (!cardData.expiryYear) {\n        errors.expiry = __('Expiry year is required', 'woocommerce-gateway-cardknox');\n    } else {\n        const currentYear = new Date().getFullYear();\n        const year = parseInt(cardData.expiryYear, 10);\n        \n        if (year < currentYear) {\n            errors.expiry = __('Card has expired', 'woocommerce-gateway-cardknox');\n        }\n        \n        // Check if card expires this year but month has passed\n        if (year === currentYear && cardData.expiryMonth) {\n            const currentMonth = new Date().getMonth() + 1;\n            const expMonth = parseInt(cardData.expiryMonth, 10);\n            \n            if (expMonth < currentMonth) {\n                errors.expiry = __('Card has expired', 'woocommerce-gateway-cardknox');\n            }\n        }\n    }\n\n    return errors;\n};\n\n/**\n * Luhn algorithm to validate card number\n * @param {string} cardNumber - Card number to validate\n * @returns {boolean} Is valid\n */\nexport const luhnCheck = (cardNumber) => {\n    const digits = cardNumber.replace(/\\D/g, '');\n    let sum = 0;\n    let isEven = false;\n\n    for (let i = digits.length - 1; i >= 0; i--) {\n        let digit = parseInt(digits[i], 10);\n\n        if (isEven) {\n            digit *= 2;\n            if (digit > 9) {\n                digit -= 9;\n            }\n        }\n\n        sum += digit;\n        isEven = !isEven;\n    }\n\n    return sum % 10 === 0;\n};\n\n/**\n * Get card type from card number\n * @param {string} cardNumber - Card number\n * @returns {string} Card type\n */\nexport const getCardType = (cardNumber) => {\n    const patterns = {\n        visa: /^4/,\n        mastercard: /^5[1-5]/,\n        amex: /^3[47]/,\n        discover: /^6(?:011|5)/,\n        jcb: /^35/,\n        diners: /^3(?:0[0-5]|[68])/,\n    };\n\n    const digits = cardNumber.replace(/\\D/g, '');\n\n    for (const [type, pattern] of Object.entries(patterns)) {\n        if (pattern.test(digits)) {\n            return type;\n        }\n    }\n\n    return 'unknown';\n};\n\n/**\n * Format card number for display\n * @param {string} cardNumber - Card number\n * @returns {string} Formatted card number\n */\nexport const formatCardNumber = (cardNumber) => {\n    const digits = cardNumber.replace(/\\D/g, '');\n    const cardType = getCardType(digits);\n\n    if (cardType === 'amex') {\n        // Format: 4-6-5\n        return digits.replace(/(\\d{4})(\\d{6})(\\d{5})/, '$1 $2 $3').trim();\n    } else {\n        // Format: 4-4-4-4\n        return digits.replace(/(\\d{4})(?=\\d)/g, '$1 ').trim();\n    }\n};\n\n/**\n * Validate CVV based on card type\n * @param {string} cvv - CVV code\n * @param {string} cardType - Type of card\n * @returns {boolean} Is valid\n */\nexport const validateCVV = (cvv, cardType) => {\n    const cvvDigits = cvv.replace(/\\D/g, '');\n    \n    if (cardType === 'amex') {\n        // American Express uses 4-digit CVV\n        return cvvDigits.length === 4;\n    } else {\n        // Other cards use 3-digit CVV\n        return cvvDigits.length === 3;\n    }\n};\n\n/**\n * Mask card number for display\n * @param {string} cardNumber - Card number\n * @returns {string} Masked card number\n */\nexport const maskCardNumber = (cardNumber) => {\n    const digits = cardNumber.replace(/\\D/g, '');\n    const last4 = digits.slice(-4);\n    const masked = digits.slice(0, -4).replace(/\\d/g, '');\n    return formatCardNumber(masked + last4);\n};\n\n/**\n * Validate card holder name\n * @param {string} name - Card holder name\n * @returns {boolean} Is valid\n */\nexport const validateCardholderName = (name) => {\n    // Allow letters, spaces, hyphens, and apostrophes\n    const namePattern = /^[a-zA-Z\\s\\-']+$/;\n    return name && name.length >= 2 && namePattern.test(name);\n};\n\n/**\n * Get card issuer name from card type\n * @param {string} cardType - Card type\n * @returns {string} Card issuer name\n */\nexport const getCardIssuerName = (cardType) => {\n    const issuers = {\n        visa: 'Visa',\n        mastercard: 'Mastercard',\n        amex: 'American Express',\n        discover: 'Discover',\n        jcb: 'JCB',\n        diners: 'Diners Club',\n        unknown: 'Unknown',\n    };\n    \n    return issuers[cardType] || issuers.unknown;\n};\n\n/**\n * Check if expiry date is within valid range\n * @param {string} month - Expiry month\n * @param {string} year - Expiry year\n * @returns {Object} Validation result with isValid and message\n */\nexport const validateExpiryDate = (month, year) => {\n    const result = {\n        isValid: true,\n        message: '',\n    };\n\n    if (!month || !year) {\n        result.isValid = false;\n        result.message = __('Expiry date is required', 'woocommerce-gateway-cardknox');\n        return result;\n    }\n\n    const currentDate = new Date();\n    const currentYear = currentDate.getFullYear();\n    const currentMonth = currentDate.getMonth() + 1;\n    const expMonth = parseInt(month, 10);\n    const expYear = parseInt(year, 10);\n\n    // Check if month is valid\n    if (expMonth < 1 || expMonth > 12) {\n        result.isValid = false;\n        result.message = __('Invalid expiry month', 'woocommerce-gateway-cardknox');\n        return result;\n    }\n\n    // Check if card has expired\n    if (expYear < currentYear || (expYear === currentYear && expMonth < currentMonth)) {\n        result.isValid = false;\n        result.message = __('Card has expired', 'woocommerce-gateway-cardknox');\n        return result;\n    }\n\n    // Check if expiry date is too far in the future (more than 20 years)\n    if (expYear > currentYear + 20) {\n        result.isValid = false;\n        result.message = __('Invalid expiry year', 'woocommerce-gateway-cardknox');\n        return result;\n    }\n\n    return result;\n};","/**\n * Payment method constants\n */\nexport const PAYMENT_METHOD_NAME = 'cardknox';\n\n/**\n * iFields configuration\n */\nexport const IFIELDS_VERSION = '2.15.2302.0801';\nexport const IFIELDS_CDN_URL = `https://cdn.cardknox.com/ifields/${IFIELDS_VERSION}/ifields.min.js`;\nexport const IFIELDS_IFRAME_URL = `https://cdn.cardknox.com/ifields/${IFIELDS_VERSION}/ifield.htm`;\n\n/**\n * Card types mapping\n */\nexport const CARD_TYPES = {\n    visa: 'Visa',\n    mastercard: 'Mastercard',\n    amex: 'American Express',\n    discover: 'Discover',\n    jcb: 'JCB',\n    diners: 'Diners Club',\n    unknown: 'Unknown',\n};\n\n/**\n * Card type patterns for detection\n */\nexport const CARD_PATTERNS = {\n    visa: /^4[0-9]{12}(?:[0-9]{3})?$/,\n    mastercard: /^5[1-5][0-9]{14}$/,\n    amex: /^3[47][0-9]{13}$/,\n    discover: /^6(?:011|5[0-9]{2})[0-9]{12}$/,\n    jcb: /^(?:2131|1800|35\\d{3})\\d{11}$/,\n    diners: /^3(?:0[0-5]|[68][0-9])[0-9]{11}$/,\n};\n\n/**\n * Error messages\n */\nexport const ERROR_MESSAGES = {\n    INVALID_CARD: 'Invalid card number',\n    INVALID_CVV: 'Invalid security code',\n    INVALID_EXPIRY: 'Invalid expiry date',\n    CARD_EXPIRED: 'Card has expired',\n    REQUIRED_FIELD: 'This field is required',\n    PROCESSING_ERROR: 'An error occurred while processing your payment',\n    TOKEN_ERROR: 'Unable to tokenize card data',\n    NETWORK_ERROR: 'Network error. Please check your connection and try again',\n    TIMEOUT_ERROR: 'Request timed out. Please try again',\n    INVALID_NAME: 'Please enter a valid cardholder name',\n    SERVER_ERROR: 'Server error. Please try again later',\n    VALIDATION_ERROR: 'Please check your card details and try again',\n};\n\n/**\n * Success messages\n */\nexport const SUCCESS_MESSAGES = {\n    PAYMENT_SUCCESS: 'Payment processed successfully',\n    CARD_SAVED: 'Card saved successfully',\n    CARD_DELETED: 'Card deleted successfully',\n};\n\n/**\n * Field placeholders\n */\nexport const FIELD_PLACEHOLDERS = {\n    CARD_NUMBER: '1234 5678 9012 3456',\n    CVV: 'CVV',\n    CVV_AMEX: 'CVVV',\n    CARD_NAME: 'Name on card',\n    EXPIRY_MONTH: 'MM',\n    EXPIRY_YEAR: 'YYYY',\n};\n\n/**\n * Field labels\n */\nexport const FIELD_LABELS = {\n    CARD_NUMBER: 'Card Number',\n    CVV: 'Security Code',\n    CARD_NAME: 'Cardholder Name',\n    EXPIRY_DATE: 'Expiry Date',\n    EXPIRY_MONTH: 'Month',\n    EXPIRY_YEAR: 'Year',\n    SAVE_CARD: 'Save to account',\n};\n\n/**\n * iFields event types\n */\nexport const IFIELD_EVENTS = {\n    INPUT: 'input',\n    CLICK: 'click',\n    FOCUS: 'focus',\n    BLUR: 'blur',\n    SUBMIT: 'submit',\n    ESCAPE: 'escape',\n    TAB: 'tab',\n    SHIFT_TAB: 'shifttab',\n    ENTER: 'enter',\n    AUTOFILL: 'autofill',\n    UPDATE: 'update',\n};\n\n/**\n * iFields style states\n */\nexport const IFIELD_STYLES = {\n    DEFAULT: {\n        border: '1px solid #ddd',\n        'font-size': '14px',\n        padding: '12px',\n        'border-radius': '4px',\n        width: '100%',\n        height: '48px',\n        'box-sizing': 'border-box',\n        'font-family': '-apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Oxygen-Sans, Ubuntu, Cantarell, \"Helvetica Neue\", sans-serif',\n        'line-height': '1.4',\n        color: '#32373c',\n        'background-color': '#fff',\n        transition: 'border-color 0.3s ease',\n    },\n    VALID: {\n        border: '1px solid #46b450',\n        'background-color': '#f0f9f0',\n    },\n    INVALID: {\n        border: '1px solid #d63638',\n        'background-color': '#fef5f5',\n    },\n    FOCUSED: {\n        border: '1px solid #007cba',\n        outline: 'none',\n        'box-shadow': '0 0 0 1px #007cba',\n    },\n};\n\n/**\n * Timeout values (in milliseconds)\n */\nexport const TIMEOUTS = {\n    TOKEN_REQUEST: 15000, // 15 seconds\n    API_REQUEST: 30000,   // 30 seconds\n    VALIDATION: 500,      // 500ms debounce for validation\n};\n\n/**\n * Regular expressions for validation\n */\nexport const REGEX = {\n    NUMBERS_ONLY: /^\\d+$/,\n    LETTERS_ONLY: /^[a-zA-Z\\s]+$/,\n    ALPHANUMERIC: /^[a-zA-Z0-9]+$/,\n    EMAIL: /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/,\n    WHITESPACE: /\\s/g,\n};\n\n/**\n * API endpoints\n */\nexport const API_ENDPOINTS = {\n    PROCESS_PAYMENT: '/wp-json/wc/store/checkout',\n    VALIDATE_CARD: '/wp-json/cardknox/v1/validate',\n    SAVE_CARD: '/wp-json/cardknox/v1/save-card',\n    DELETE_CARD: '/wp-json/cardknox/v1/delete-card',\n};\n\n/**\n * Local storage keys\n */\nexport const STORAGE_KEYS = {\n    LAST_CARD_TYPE: 'cardknox_last_card_type',\n    PREFERRED_SAVE_METHOD: 'cardknox_save_preference',\n};\n\n/**\n * Card number lengths by type\n */\nexport const CARD_NUMBER_LENGTHS = {\n    visa: [13, 16, 19],\n    mastercard: [16],\n    amex: [15],\n    discover: [16, 19],\n    jcb: [16, 17, 18, 19],\n    diners: [14, 15, 16, 17, 18, 19],\n};\n\n/**\n * CVV lengths by card type\n */\nexport const CVV_LENGTHS = {\n    visa: 3,\n    mastercard: 3,\n    amex: 4,\n    discover: 3,\n    jcb: 3,\n    diners: 3,\n};\n\n/**\n * Default configuration\n */\nexport const DEFAULT_CONFIG = {\n    autoFormat: true,\n    autoSubmit: true,\n    enableValidation: true,\n    showCardIcon: true,\n    requireCVV: true,\n    allowSaveCard: true,\n    validateOnBlur: true,\n    maskCardNumber: true,\n    animateOnError: true,\n};","module.exports = window[\"wp\"][\"element\"];","module.exports = window[\"wp\"][\"htmlEntities\"];","module.exports = window[\"wp\"][\"i18n\"];","module.exports = window[\"React\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * External dependencies - using global WooCommerce objects\n */\nconst { registerPaymentMethod } = window.wc.wcBlocksRegistry;\n\n/**\n * Internal dependencies\n */\nimport CardknoxPaymentMethod from './cardknox-payment-method';\n\n// Register the payment method when DOM is ready\nif (registerPaymentMethod) {\n    registerPaymentMethod(CardknoxPaymentMethod);\n}"],"names":["__","decodeEntities","createElement","CardknoxPaymentForm","PAYMENT_METHOD_NAME","getSettings","window","wc","wcSettings","getSetting","settings","defaultLabel","label","title","Content","props","Label","CardknoxPaymentMethod","name","content","edit","canMakePayment","ariaLabel","supports","features","_settings$supports","showSaveOption","_settings$showSaveOpt","showSavedCards","Array","isArray","savedCards","length","placeOrderButtonLabel","useEffect","cardLogoUrl","CardknoxIFields","errors","onExpiryChange","ValidationInputError","cardData","currentYear","Date","getFullYear","validateExpiry","expiryMonth","expiryYear","currentDate","currentMonth","getMonth","expMonth","parseInt","expYear","cardContainer","document","querySelector","cvvContainer","style","border","className","id","display","color","marginBottom","paddingBottom","margin","width","lineHeight","fontWeight","htmlFor","position","overflow","backgroundColor","height","src","frameBorder","right","top","transform","backgroundImage","backgroundSize","backgroundRepeat","backgroundPosition","pointerEvents","cardNumber","errorMessage","gap","flex","inputMode","autoComplete","autoCorrect","autoCapitalize","spellCheck","type","placeholder","outline","expiry","borderRadius","padding","boxSizing","fontSize","onChange","e","value","target","replace","formattedValue","substr","month","year","cvv","useState","useCallback","useRef","SavePaymentCheckbox","useCardknoxIFields","validateCardData","eventRegistration","events","emitResponse","components","setErrors","isValid","setIsValid","saveCard","setSaveCard","selectedToken","setSelectedToken","setCardData","cardNumberToken","cvvToken","renderCountRef","prevGetTokensRef","prevCardDataRef","emitResponseRef","getTokensRef","cardDataRef","saveCardRef","selectedTokenRef","errorsRef","eventRegistrationRef","paymentSubscriptionRef","subscribed","unsubscribe","current","initializeIFields","getTokens","clearFields","focusField","changed","sameRef","role","attemptInit","hasKey","iFieldsKey","hasSDK","setAccount","setIfieldStyle","addIfieldCallback","softwareName","softwareVersion","onUpdate","handleIFieldUpdate","t","setTimeout","clearTimeout","isUnmounted","timeoutId","trySubscribe","registration","onSetup","onPaymentSetup","onProcessing","onPaymentProcessing","paymentEvent","emitRes","selected","card","responseTypes","SUCCESS","meta","paymentMethodData","wc_token","validationErrors","Object","keys","ERROR","message","tokens","cardknox_card_token","cardknox_cvv_token","cardknox_exp_month","cardknox_exp_year","cardknox_save_card","error","data","newErrors","lastActiveField","cardNumberLength","undefined","cardNumberIsValid","cvvLength","cvvIsValid","cardNumberValid","cvvValid","handleExpiryChange","field","prev","handleTokenChange","token","Fragment","checked","xmlns","viewBox","d","isInitializedRef","updateCallbackRef","clearWooNotices","groups","querySelectorAll","forEach","g","remove","defaultStyle","defaultStyleCvv","validStyle","invalidStyle","validStyleCvv","invalidStyleCvv","enableAutoFormatting","enableEnterKey","cardNumberError","cvvError","cardLen","cvvLen","textContent","setAttribute","amex","issuer","expectedLen","cvvLooksValid","addIfieldKeyPressCallback","Promise","resolve","reject","Error","currentCardTok","currentCvvTok","finished","tid","focusIfield","cardNumberErrorEl","cvvErrorEl","last","getLastIfieldState","clearIfield","fieldName","luhnCheck","digits","sum","isEven","i","digit","getCardType","patterns","visa","mastercard","discover","jcb","diners","pattern","entries","test","formatCardNumber","cardType","trim","validateCVV","cvvDigits","maskCardNumber","last4","slice","masked","validateCardholderName","namePattern","getCardIssuerName","issuers","unknown","validateExpiryDate","result","IFIELDS_VERSION","IFIELDS_CDN_URL","IFIELDS_IFRAME_URL","CARD_TYPES","CARD_PATTERNS","ERROR_MESSAGES","INVALID_CARD","INVALID_CVV","INVALID_EXPIRY","CARD_EXPIRED","REQUIRED_FIELD","PROCESSING_ERROR","TOKEN_ERROR","NETWORK_ERROR","TIMEOUT_ERROR","INVALID_NAME","SERVER_ERROR","VALIDATION_ERROR","SUCCESS_MESSAGES","PAYMENT_SUCCESS","CARD_SAVED","CARD_DELETED","FIELD_PLACEHOLDERS","CARD_NUMBER","CVV","CVV_AMEX","CARD_NAME","EXPIRY_MONTH","EXPIRY_YEAR","FIELD_LABELS","EXPIRY_DATE","SAVE_CARD","IFIELD_EVENTS","INPUT","CLICK","FOCUS","BLUR","SUBMIT","ESCAPE","TAB","SHIFT_TAB","ENTER","AUTOFILL","UPDATE","IFIELD_STYLES","DEFAULT","transition","VALID","INVALID","FOCUSED","TIMEOUTS","TOKEN_REQUEST","API_REQUEST","VALIDATION","REGEX","NUMBERS_ONLY","LETTERS_ONLY","ALPHANUMERIC","EMAIL","WHITESPACE","API_ENDPOINTS","PROCESS_PAYMENT","VALIDATE_CARD","DELETE_CARD","STORAGE_KEYS","LAST_CARD_TYPE","PREFERRED_SAVE_METHOD","CARD_NUMBER_LENGTHS","CVV_LENGTHS","DEFAULT_CONFIG","autoFormat","autoSubmit","enableValidation","showCardIcon","requireCVV","allowSaveCard","validateOnBlur","animateOnError","registerPaymentMethod","wcBlocksRegistry"],"sourceRoot":""}